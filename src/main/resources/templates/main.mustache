{{> layout/header}}
<div class="tab-nav-container">
    <div class="tab-nav">
        <button class="tab-button active" data-tab="tab-1">ë‚´ ì†Œì…œ</button>
        <button class="tab-button" data-tab="tab-2">ì†Œì…œ ì°¾ê¸°</button>
    </div>
</div>
<div id="tab-1" class="tab-content active">
    <div class="my-full-width-section my-section1">
        <div class="my-section">
            <div class="my-cards-container">
                <div class="my-card">
                    <div class="plus-icon" style="font-size: 50px;">+</div>
                    <div class="my-title">ìƒˆ ì†Œì…œ ë§Œë“¤ê¸°</div>
                </div>
                {{#model.mySocialList}}
                    <div class="my-card">
                        <img src="{{imagePath}}" alt="{{name}}">
                        <div class="my-title">SNS í”„ë¡œì íŠ¸ 1ì¡°</div>
                        <div class="my-subtitle">ë©¤ë²„ìˆ˜ : {{memberCount}}</div>
                    </div>
                {{/model.mySocialList}}
            </div>
        </div>
    </div>
    <div class="my-full-width-section my-section2">
        <div class="my-section">
            <h3>ë‚´ ì†Œì…œì˜ ì¸ê¸°ê¸€</h3>
            <div class="my-posts-container">
                {{#model.mySocialPopularList}}
                    <div class="my-post">
                        <div class="my-title">{{socialName}}</div>
                        <div class="my-separator"></div>
                        <div class="my-content-flex">
                            <div class="my-content">
                                {{{content}}}
                            </div>
                            <img src="{{socialImage}}" alt="{{socialName}}" class="my-image-right">
                        </div>
                        <div class="my-footer">
                            <div>ğŸ˜ŠğŸ˜ {{likeCount}}</div>
                            <div>ğŸ’¬ {{replyCount}}</div>
                        </div>
                    </div>
                {{/model.mySocialPopularList}}
            </div>
        </div>
    </div>
    <div class="my-full-width-section my-section4">
        <div class="my-section">
            <h3>ì´ëŸ° ì†Œì…œì€ ì–´ë•Œìš”</h3>
            <div class="my-recommendation-container">
                {{#model.categoryList}}
                    <div class="my-recommendation-item">
                        <img src="{{image}}" alt="ìš°ì£¼,ì²œì²´ê´€ì¸¡,ì²œì²´ì‚¬ì§„ ì†Œì…œ">
                        <div class="my-details">
                            <div class="my-title">{{socialName}}</div>
                            <div class="my-subtitle">{{info}}</div>
                        </div>
                        <button class="tab-button my-more-button my-scroll-item2" data-tab="tab-2" data-category-id="{{id}}">{{categoryName}} ì†Œì…œ ë”ë³´ê¸° ></button>
                    </div>
                {{/model.categoryList}}
            </div>
        </div>
    </div>
    <div class="my-full-width-section my-section4">
        <div class="my-section">
            <h3>ì˜¤ëŠ˜ì˜ ì¸ê¸°ê¸€</h3>
            <div class="my-posts-container">
                {{#model.popularPostList}}
                    <div class="my-post">
                        <div class="my-title">{{name}}</div>
                        <div class="my-separator"></div>
                        <div class="my-content-flex">
                            <div class="my-content">
                                {{{content}}}
                            </div>
                            <img src="{{image}}" alt="{{name}}" class="my-image-right">
                        </div>
                        <div class="my-footer">
                            <div>ğŸ˜ŠğŸ˜ {{likeCount}}</div>
                            <div>ëŒ“ê¸€ {{replyCount}}</div>
                        </div>
                    </div>
                {{/model.popularPostList}}
            </div>
        </div>
    </div>
</div>

<div id="tab-2" class="tab-content">
    <div class="my-full-width-section my-section3">
        <div class="my-section">
            <h3>ì£¼ì œë³„ ì†Œì…œì„ ì°¾ì•„ë³´ì„¸ìš”!</h3>
            <div class="my-search-bar">
                <i class="fa fa-search"></i>
                <input type="text" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”...">
            </div>
            <div class="my-scroll-container">
                <button class="my-scroll-button" id="scroll-left">&lt;</button>
                <div class="my-scroll-wrapper" id="scroll-wrapper">
                    <div class="my-scroll-item">ì „ì²´</div>
                    {{#model.categoryNameList}}
                        <button class="my-scroll-item my-scroll-item2" data-category-id="{{id}}">{{name}}</button>
                    {{/model.categoryNameList}}
                </div>
                <button class="my-scroll-button" id="scroll-right">&gt;</button>
            </div>
        </div>
    </div>
    <div class="my-full-width-section my-section1">
        <div class="my-section">
            <div class="my-grid-container category-social-list">
                <!-- AJAX ìš”ì²­ì— ì˜í•´ ì†Œì…œ ë¦¬ìŠ¤íŠ¸ê°€ ì—¬ê¸°ì— ì¶”ê°€ë©ë‹ˆë‹¤. -->
            </div>
            <div class="my-pagination">
                <button class="disabled">&lt; ì´ì „</button>
                <button>1</button>
                <button>2</button>
                <button>3</button>
                <button>ë‹¤ìŒ &gt;</button>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        // íƒ­ ì „í™˜
        const tabs = document.querySelectorAll('.tab-button');
        const tabContents = document.querySelectorAll('.tab-content');

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì²« ë²ˆì§¸ íƒ­ ê¸°ë³¸ìœ¼ë¡œ ë³´ì´ê²Œ í•¨
        document.querySelector('.tab-button').click();

        // íƒ­ ë²„íŠ¼ í´ë¦­ ì‹œ ì²˜ë¦¬í•˜ëŠ” í•¨ìˆ˜
        function handleTabButtonClick(button) {
            // ëª¨ë“  ë²„íŠ¼ì—ì„œ 'active' í´ë˜ìŠ¤ ì œê±°
            tabs.forEach(btn => btn.classList.remove('active'));
            // í´ë¦­ëœ ë²„íŠ¼ì— 'active' í´ë˜ìŠ¤ ì¶”ê°€
            button.classList.add('active');

            // í´ë¦­ëœ ë²„íŠ¼ì— í•´ë‹¹í•˜ëŠ” íƒ­ ID ê°€ì ¸ì˜¤ê¸°
            const tabId = button.getAttribute('data-tab');
            if (tabId) {
                // ëª¨ë“  íƒ­ ì½˜í…ì¸  ìˆ¨ê¸°ê¸°
                tabContents.forEach(content => {
                    content.style.display = 'none';
                });

                // í´ë¦­ëœ ë²„íŠ¼ì— í•´ë‹¹í•˜ëŠ” ì½˜í…ì¸  ë³´ì´ê¸°
                const tabContent = document.getElementById(tabId);
                if (tabContent) {
                    tabContent.style.display = 'block';
                } else {
                    console.error(`Tab content with ID '${tabId}' not found.`);
                }
            } else {
                console.error('Button does not have data-tab attribute.');
            }
        }

        // ì¹´í…Œê³ ë¦¬ ê°€ë¡œìŠ¤í¬ë¡¤
        const scrollWrapper = document.getElementById('scroll-wrapper');
        const scrollLeft = document.getElementById('scroll-left');
        const scrollRight = document.getElementById('scroll-right');

        scrollLeft.addEventListener('click', () => {
            scrollWrapper.scrollBy({
                left: -200,
                behavior: 'smooth'
            });
        });

        scrollRight.addEventListener('click', () => {
            scrollWrapper.scrollBy({
                left: 200,
                behavior: 'smooth'
            });
        });

        // ëª¨ë“  íƒ­ ë²„íŠ¼ì— í´ë¦­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
        tabs.forEach(button => {
            button.addEventListener('click', () => {
                handleTabButtonClick(button);
            });
        });


        // ì¹´í…Œê³ ë¦¬ ë²„íŠ¼ í´ë¦­ ì‹œ AJAX ìš”ì²­ ì²˜ë¦¬
        document.querySelectorAll('.my-scroll-item2').forEach(item => {
            item.addEventListener('click', function () {
                const categoryId = this.getAttribute('data-category-id');

                $.ajax({
                    url: "/main/category",
                    type: "GET",
                    data: {categoryId: categoryId},
                    success: function (response) {
                        const socialList = response; // ì„œë²„ì—ì„œ ë°˜í™˜ëœ ì†Œì…œ ë¦¬ìŠ¤íŠ¸
                        console.log(response);
                        const categorySocialList = document.querySelector('.category-social-list');

                        // ê¸°ì¡´ ì†Œì…œ ë¦¬ìŠ¤íŠ¸ ì´ˆê¸°í™”
                        categorySocialList.innerHTML = '';

                        // ìƒˆë¡œìš´ ì†Œì…œ ë¦¬ìŠ¤íŠ¸ ì¶”ê°€
                        socialList.forEach(social => {
                            const socialCard = `
                            <div class="my-grid-item">
                                <img src="${social.image}" alt="${social.name}">
                                <div class="my-details">
                                    <div class="my-title">${social.name}</div>
                                    <div class="my-subtitle">ë¦¬ë” : ${social.nickName}</div>
                                    <div class="my-participants">${social.memberCount} ëª…ì´ í•¨ê»˜í•˜ê³  ìˆì–´ìš”.</div>
                                    <div class="my-join-button">ì§€ê¸ˆ ì°¸ì—¬í•˜ê¸°</div>
                                </div>
                            </div>
                            `;
                            categorySocialList.innerHTML += socialCard;
                        });
                    },
                    error: function (error) {
                        alert('ì†Œì…œ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                    }
                });
            });
        });
    });
</script>

{{> layout/footer }}
